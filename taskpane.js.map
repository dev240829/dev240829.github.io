{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","//import { FlexMailItem, getEMLFile } from \"../modules/globals\";\n\n/* global Office */\n\n// sideload: https://aka.ms/olksideload\n\nOffice.onReady((info) => {\n  console.log(`%c Flex365x Outlook Addin: ${getBuildDateString()} A`, \"background: #555; color: #fff; padding: 3px;\");\n  console.log(\"taskpane ready\");\n  Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, itemChanged);\n  document.querySelector(\"#flex-init\").style.display = \"none\";\n  updateReadUI();\n});\n\nconst getBuildDateString = () => {\n  const date = new Date(111111);\n\n  const months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\n  //const mins: string = (date.getMinutes() < 10 ? '0' : '') + date.getMinutes().toString();\n\n  return (\n    months[date.getMonth()] +\n    \" \" +\n    date.getDate().toString() +\n    \" \" +\n    date.getFullYear().toString() +\n    \" \" +\n    (date.getHours() < 10 ? \"0\" : \"\") +\n    date.getHours().toString() +\n    \":\" +\n    (date.getMinutes() < 10 ? \"0\" : \"\") +\n    date.getMinutes().toString()\n  );\n};\n\nconst openFlexSite = (searchTerm) => {\n  //window.open(`https://ccscreative.sharepoint.com/sites/Flex365/SitePages/Home.aspx?search=${searchTerm}`);\n  window.open(`https://44g7q3.sharepoint.com/sites/Flex/SitePages/CollabHome.aspx?sw=bypass&search=${searchTerm}`);\n  //window.open(`https://44g7q3.sharepoint.com/sites/Flex/_layouts/15/viewlsts.aspx?sw=bypass&search=${searchTerm}`);\n  //window.open(`https://salespro1.sharepoint.com/sites/FLEX365xDemo/SitePages/Home.aspx?sw=bypass&search=${searchTerm}`);\n};\n\nconst getEMLFile = (item) => {\n  let emlContents = \"\";\n\n  const splitLines = (theString, partSize) => {\n    let retVal = \"\";\n    const res = [];\n\n    let idx = 0;\n    let part = \"\";\n    do {\n      part = theString.substr(idx, partSize);\n      if (part !== \"\") {\n        res.push(part);\n      }\n      idx += partSize;\n    } while (part !== \"\");\n\n    if (res.length > -1) {\n      retVal = res.join(\"\\r\\n\");\n    }\n    return retVal;\n  };\n\n  emlContents += `To: ${item.to}\\r\\nFrom: ${item.sender}\\r\\nCC: ${item.cc}\\r\\nSubject: ${item.subject}\\r\\nDate: ${item.date}\\r\\n`;\n  emlContents += \"Content-Type: multipart/mixed; boundary=--boundary_text_string\\r\\n\";\n  emlContents += \"\\r\\n----boundary_text_string\\r\\nContent-Type: text/html; charset=ISO-8859-1\\r\\n\";\n  emlContents += \"Content-Transfer-Encoding: quoted-printable\\r\\n\\r\\n\";\n\n  emlContents += `<html><head></head><body>${item.body}</body></html>`;\n\n  for (const attachment of item.attachments) {\n    emlContents += \"\\r\\n\\r\\n----boundary_text_string\\r\\n\";\n    emlContents += `Content-Type: ${attachment.contentType}; name=\"${attachment.name}\"\\r\\n`;\n    emlContents += `Content-Disposition: attachment; filename=\"${attachment.name}\"; size=${attachment.size.toString()}\\r\\n`;\n    emlContents += \"Content-Transfer-Encoding: base64\\r\\n\\r\\n\";\n    //emlContents += `${attachment.base64Content}`;\n    emlContents += `${splitLines(attachment.base64Content, 76)}`;\n  }\n\n  emlContents += \"\\r\\n\\r\\n----boundary_text_string--\";\n\n  return emlContents;\n};\n\nconst readDragger = (e) => {\n  e.dataTransfer.setData(\n    \"text\",\n    JSON.stringify({\n      to: theMailItem.to,\n      sender: theMailItem.sender,\n      subject: theMailItem.subject,\n      date: theMailItem.date,\n      cc: theMailItem.cc,\n      body: theMailItem.body,\n      numAttachments: theMailItem.attachments.length.toString(),\n      filename: `${theMailItem.subject.replace(/[^a-z0-9+]+/gi, \"_\")}_${new Date().getMilliseconds().toString()}${Math.floor(Math.random() * 1000)}.eml`,\n      eml: getEMLFile(theMailItem),\n    })\n  );\n};\n\nconst getAttachment = (item, attachmentId) => {\n  return (\n    new Promise() <\n    Office.AsyncResult <\n    Office.AttachmentContent >>\n      ((resolve, reject) => {\n        item.getAttachmentContentAsync(attachmentId, null, (content) => {\n          if (content.status === Office.AsyncResultStatus.Succeeded) {\n            resolve(content);\n          } else {\n            reject(content);\n          }\n        });\n      })\n  );\n};\n\nconst updateReadUI = () => {\n  console.log(\"updateReadUI called\");\n\n  const mainBody = document.querySelector(\"#flex-app-body\");\n  const prompt = document.querySelector(\"#flex-select-item-prompt\");\n  const wait = document.querySelector(\"#flex-wait\");\n  const searchLinkToContainer = document.querySelector(\"#flex-search-to-container\");\n  const searchLinkSenderName = document.querySelector(\"#flex-search-link-sender-name\");\n  const searchLinkSenderAddress = document.querySelector(\"#flex-search-link-sender-address\");\n\n  if (searchLinkToContainer && searchLinkSenderName && searchLinkSenderAddress && mainBody && prompt && wait) {\n    mainBody.style.display = \"none\";\n    prompt.style.display = \"none\";\n    wait.style.display = \"flex\";\n    searchLinkToContainer.replaceChildren();\n    searchLinkSenderName.replaceChildren();\n    searchLinkSenderAddress.replaceChildren();\n  } else {\n    // can't find our container, we'll bail\n    return;\n  }\n\n  const theItem = Office.context.mailbox.item;\n  const tempItem = {\n    to: \"\",\n    sender: \"\",\n    subject: \"\",\n    date: \"\",\n    cc: \"\",\n    body: \"\",\n    attachments: [],\n  };\n\n  if (!theItem) {\n    wait.style.display = \"none\";\n    prompt.style.display = \"flex\";\n    return;\n  }\n\n  tempItem.sender = getEmailString(theItem.sender);\n  tempItem.date = `${theItem.dateTimeCreated.toUTCString()}`;\n  theItem.to.forEach((address) => {\n    tempItem.to += (tempItem.to.length > 0 ? \"; \" : \"\") + getEmailString(address);\n  });\n\n  theItem.cc.forEach((address) => {\n    tempItem.cc += (tempItem.cc.length > 0 ? \"; \" : \"\") + getEmailString(address);\n  });\n\n  tempItem.subject = theItem.subject;\n  // theItem.body.getAsync(Office.CoercionType.Html, null, async (b) => {\n  //   theItemRef.current.body = b.value;\n\n  theItem.body.getAsync(Office.CoercionType.Html, null, async (b) => {\n    tempItem.body = b.value;\n\n    // tslint:disable\n\n    for (const attachment of theItem.attachments) {\n      try {\n        const content = await getAttachment(theItem, attachment.id);\n        tempItem.attachments.push({\n          id: attachment.id,\n          name: attachment.name,\n          contentType: attachment.contentType,\n          size: attachment.size,\n          base64Content: content.value.content,\n        });\n\n        //console.log(content);\n      } catch (err) {\n        console.log(\"error caught\");\n        console.log(err);\n      }\n    }\n\n    theMailItem = Object.assign({}, tempItem);\n\n    const dragElement = document.querySelector(\"#flex-drag-envelope\");\n    if (dragElement) {\n      dragElement.addEventListener(\"dragstart\", readDragger);\n    }\n\n    // sender\n    const senderNameLink = document.createElement(\"a\");\n    senderNameLink.href = \"javascript:void(0)\";\n    senderNameLink.innerText = theItem.sender.displayName;\n    senderNameLink.addEventListener(\"click\", () => openFlexSite(`${theItem.sender.displayName}`));\n\n    searchLinkSenderName.replaceChildren();\n    searchLinkSenderName.append(senderNameLink);\n\n    const senderNameAddress = document.createElement(\"a\");\n    senderNameAddress.href = \"javascript:void(0)\";\n    senderNameAddress.innerText = theItem.sender.emailAddress;\n    senderNameAddress.addEventListener(\"click\", () => openFlexSite(`${theItem.sender.emailAddress}`));\n\n    searchLinkSenderAddress.replaceChildren();\n    searchLinkSenderAddress.append(senderNameAddress);\n\n    //flex-search-to-container\n\n    const searchLinkToContainer = document.querySelector(\"#flex-search-to-container\");\n    if (searchLinkToContainer) {\n      searchLinkToContainer.replaceChildren();\n      theItem.to.forEach((to) => {\n        if (to.emailAddress !== theItem.sender.emailAddress) {\n          const div = document.createElement(\"div\");\n\n          const linkName = document.createElement(\"a\");\n          linkName.href = \"javascript:void(0)\";\n          linkName.innerHTML = `${to.displayName}`;\n          linkName.addEventListener(\"click\", () => openFlexSite(`${linkName.innerHTML}`));\n\n          div.appendChild(linkName);\n          if (searchLinkToContainer.children.length > 0) {\n            div.style.paddingTop = \"10px\";\n          }\n\n          searchLinkToContainer.appendChild(div);\n\n          if (to.displayName !== to.emailAddress) {\n            const div2 = document.createElement(\"div\");\n            const linkAddress = document.createElement(\"a\");\n            linkAddress.href = \"javascript:void(0)\";\n            linkAddress.innerHTML = `${to.emailAddress}`;\n\n            linkAddress.addEventListener(\"click\", () => openFlexSite(`${linkAddress.innerHTML}`));\n\n            div2.appendChild(linkAddress);\n            searchLinkToContainer.appendChild(div2);\n          }\n        }\n      });\n    }\n    wait.style.display = \"none\";\n    prompt.style.display = \"none\";\n    mainBody.style.visibility = \"hidden\";\n    mainBody.style.display = \"flex\";\n\n    // set height\n    const divElement = searchLinkToContainer;\n    divElement.style.resize = \"\";\n    divElement.style.overflow = \"\";\n    divElement.style.height = \"auto\";\n\n    if (divElement.getBoundingClientRect().height > 120) {\n      divElement.style.resize = \"vertical\";\n      divElement.style.overflow = \"auto\";\n      divElement.style.height = \"120px\";\n    }\n\n    mainBody.style.visibility = \"\";\n  });\n};\n\nconst getEmailString = (details) => {\n  return `${details.displayName}${details.displayName.indexOf(\"@\") === -1 ? ` (${details.emailAddress})` : \"\"}`;\n};\n\nfunction itemChanged(e) {\n  console.log(\"hit2\");\n  updateReadUI();\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"../../assets/spin.gif\", import.meta.url);\n// Module\nvar code = \" <!doctype html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Flex365x Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <div id=\\\"flex-init\\\" style=\\\"padding:50px 20px;font-size:16px;justify-content:center;width:100%;box-sizing:border-box;display:grid;grid-template-columns:1fr 2fr;column-gap:15px;align-items:center\\\"> <div style=\\\"justify-self:flex-end\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"/> </div> <div style=\\\"justify-self:flex-start\\\"> <span>Waiting for Outlook...</span> </div> </div> <header class=\\\"ms-welcome__header\\\" style=\\\"padding:10px 20px 0 20px;flex-direction:row;justify-content:center\\\"> <img width=\\\"60\\\" height=\\\"60\\\" src=\\\"https://i.ibb.co/HYRQ7Sb/flex365x-icon.png\\\" alt=\\\"Flex365x\\\" title=\\\"Flex365x\\\"/> <span>&nbsp;</span> <span class=\\\"ms-font-su\\\" style=\\\"font-size:32px\\\">Welcome</span> </header> <div id=\\\"flex-wait\\\" style=\\\"padding:50px 20px;font-size:16px;display:none;justify-content:center;width:100%;box-sizing:border-box\\\"> <span>Loading item details...</span> </div> <div id=\\\"flex-select-item-prompt\\\" style=\\\"padding:50px 20px;font-size:16px;display:none;justify-content:center;width:100%;box-sizing:border-box\\\"> <span> Select an item first for options to save to Flex365x </span> </div> <main id=\\\"flex-app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div style=\\\"width:100%;text-align:center;padding:15px 0 0 0\\\"> <div style=\\\"color:#0178d4;cursor:grab;display:inline-block\\\" draggable=\\\"true\\\" title=\\\"Drag me!\\\" id=\\\"flex-drag-envelope\\\"> <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"48\\\" height=\\\"48\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-envelope-fill\\\" viewBox=\\\"0 0 16 16\\\"> <path d=\\\"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z\\\"/> </svg> </div> </div> <div style=\\\"padding-top:15px;font-size:16px;font-weight:400\\\">Search for:</div> <div style=\\\"margin:10px 0 15px 0;font-size:16px;font-weight:400;width:280px\\\"> <div>Sender:</div> <span id=\\\"flex-search-link-sender-name\\\" style=\\\"padding-right:20px\\\"> </span> <span id=\\\"flex-search-link-sender-address\\\"> </span> </div> <div style=\\\"width:280px;font-size:16px;font-weight:400\\\">Recipient(s):</div> <div id=\\\"flex-search-to-container\\\" style=\\\"padding:0 0 15px 0;font-size:16px;font-weight:400;width:280px\\\"></div> <div style=\\\"padding-top:5px;font-size:16px;font-weight:400\\\">or</div> <div style=\\\"padding:5px 25px 25px 25px;font-size:16px;font-weight:400\\\"> <div style=\\\"padding-bottom:15px\\\">Drag the above envelope to a:</div> <div style=\\\"text-align:left;padding-bottom:15px;padding-left:30px\\\"> <ul> <li>Display form</li> <li>List Processor</li> <li>Super Search result</li> </ul> </div> <div>in a Flex365x site to upload this message to that item</div> <div style=\\\"padding:20px 0 0 0\\\">You can also drag the envelope to a Leads list to create a Lead!!</div> <div style=\\\"font-size:12px;padding:25px\\\">Code update 8/29/24 0909</div> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","o","obj","prop","Object","prototype","hasOwnProperty","call","p","b","document","baseURI","self","location","href","Office","onReady","info","console","log","getBuildDateString","context","mailbox","addHandlerAsync","EventType","ItemChanged","itemChanged","querySelector","style","display","updateReadUI","date","Date","getMonth","getDate","toString","getFullYear","getHours","getMinutes","openFlexSite","searchTerm","window","open","getEMLFile","item","emlContents","splitLines","theString","partSize","retVal","res","idx","part","substr","push","length","join","to","sender","cc","subject","body","attachment","attachments","contentType","name","size","base64Content","readDragger","e","dataTransfer","setData","JSON","stringify","theMailItem","numAttachments","filename","replace","getMilliseconds","Math","floor","random","eml","getAttachment","attachmentId","Promise","AsyncResult","AttachmentContent","resolve","reject","getAttachmentContentAsync","content","status","AsyncResultStatus","Succeeded","mainBody","prompt","wait","searchLinkToContainer","searchLinkSenderName","searchLinkSenderAddress","replaceChildren","theItem","tempItem","getEmailString","dateTimeCreated","toUTCString","forEach","address","getAsync","CoercionType","Html","async","value","id","err","assign","dragElement","addEventListener","senderNameLink","createElement","innerText","displayName","append","senderNameAddress","emailAddress","div","linkName","innerHTML","appendChild","children","paddingTop","div2","linkAddress","visibility","divElement","resize","overflow","height","getBoundingClientRect","details","indexOf","URL"],"sourceRoot":""}