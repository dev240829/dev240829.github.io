let _mailBox,_customProps,_flexItemId,_theMailItem={to:"",sender:"",subject:"",date:"",cc:"",body:"",attachments:[]};function onMessageSendHandler(e){_mailBox=Office.context.mailbox;let t=_mailBox.item;console.log(19);let o="";_theMailItem.sender=`${Office.context.mailbox.userProfile.displayName} (${Office.context.mailbox.userProfile.emailAddress})`,t.to.getAsync((l=>{l.value.forEach((e=>{""===o&&(o=e.emailAddress),_theMailItem.to+=(_theMailItem.to.length>0?"; ":"")+getEmailString(e)})),console.log(26),t.cc.getAsync((l=>{l.value.forEach((e=>{_theMailItem.cc+=(_theMailItem.cc.length>0?"; ":"")+getEmailString(e)})),t.body.getAsync(Office.CoercionType.Html,null,(l=>{_theMailItem.body=l.body,t.subject.getAsync((l=>{_theMailItem.subject=l.value,t.getAttachmentsAsync((l=>{console.log(42,l),(async()=>{for(const e of l.value){console.log(45);const o=await getAttachmentsContent(t,e.id);console.log(49,o)}console.log(54,_theMailItem),Office.context.ui.displayDialogAsync(`https://44g7q3.sharepoint.com/sites/Flex/SitePages/CollabHome.aspx?search=${o}`,(t=>{navigator.clipboard.setData("Text",JSON.stringify(_theMailItem)),console.log("63",t),setTimeout((()=>{e.completed({allowEvent:!0})}),1e4)})),console.log(58)})()}))}))}))}))}))}Office.initialize=function(e){};const showFlexSite=e=>{Office.context.ui.displayDialogAsync(`https://ccscreative.sharepoint.com/sites/Flex365/SitePages/Home.aspx?search=${e}`,(e=>{console.log("63",e)}))},getAttachmentsContent=async(e,t)=>new Promise((async(o,l)=>{console.log(72,t),e.getAttachmentContentAsync(t,(e=>{console.log(74),o(e.value)}))})),getEmailString=e=>`${e.displayName}${-1===e.displayName.indexOf("@")?` (${e.emailAddress})`:""}`;