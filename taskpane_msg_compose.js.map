{"version":3,"file":"taskpane_msg_compose.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane_msg_compose.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane_msg_compose.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t881: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","//import { FlexMailItem, getBuildDateString, getEmailString, getEMLFile } from \"../modules/globals\";\r\n\r\n/* global document, Office */\r\n\r\nlet _theMailItem = {\r\n  to: \"\",\r\n  sender: \"\",\r\n  subject: \"\",\r\n  date: \"\",\r\n  cc: \"\",\r\n  body: \"\",\r\n  attachments: [],\r\n};\r\n\r\nlet recipString = \"\";\r\nlet recipientOneEmail = \"\";\r\nlet toArray = [];\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Outlook) {\r\n    recipString = \"\";\r\n\r\n    console.log(\"Flex365x Outlook Addin: compose\");\r\n\r\n    document.querySelector(\"#cflex-app-body\").style.display = \"flex\";\r\n    //updateUI();\r\n\r\n    const interval = setInterval(() => {\r\n      const mainBody = document.querySelector(\"#cflex-app-body\");\r\n\r\n      if (mainBody.checkVisibility()) {\r\n        // check recips and compare with our saved string\r\n        const item = Office.context.mailbox.item;\r\n        toArray = [];\r\n\r\n        let tempRecipString = \"\";\r\n\r\n        item.to.getAsync((a) => {\r\n          for (let i = 0; i < a.value.length; i++) {\r\n            const to = a.value[i];\r\n            if (recipientOneEmail === \"\") {\r\n              recipientOneEmail = to.emailAddress;\r\n            }\r\n\r\n            toArray.push({\r\n              displayName: to.displayName,\r\n              emailAddress: to.emailAddress,\r\n            });\r\n            tempRecipString += to.emailAddress;\r\n          }\r\n\r\n          updateComposeUI(tempRecipString != recipString, toArray, recipientOneEmail);\r\n          recipString = tempRecipString;\r\n        });\r\n      } else {\r\n        clearInterval(interval);\r\n      }\r\n    }, 1000);\r\n  }\r\n});\r\n\r\nconst getEmailString2 = (details) => {\r\n  let retVal = details.displayName;\r\n  if (details.displayName.indexOf(\"@\") === -1) {\r\n    retVal += \" (\" + details.emailAddress + \")\";\r\n  }\r\n\r\n  return retVal;\r\n\r\n  // return `${details.displayName}${details.displayName.indexOf(\"@\") === -1 ? ` (${details.emailAddress})` : \"\"}`;\r\n};\r\n\r\nconst getEMLFile2 = (item) => {\r\n  let emlContents = \"\";\r\n\r\n  const splitLines = (theString, partSize) => {\r\n    let retVal = \"\";\r\n    const res = [];\r\n\r\n    let idx = 0;\r\n    let part = \"\";\r\n    do {\r\n      part = theString.substr(idx, partSize);\r\n      if (part !== \"\") {\r\n        res.push(part);\r\n      }\r\n      idx += partSize;\r\n    } while (part !== \"\");\r\n\r\n    if (res.length > -1) {\r\n      retVal = res.join(\"\\r\\n\");\r\n    }\r\n    return retVal;\r\n  };\r\n\r\n  emlContents += `To: ${item.to}\\r\\nFrom: ${item.sender}\\r\\nCC: ${item.cc}\\r\\nSubject: ${item.subject}\\r\\nDate: ${new Date().toUTCString()}\\r\\n`;\r\n  emlContents += \"Content-Type: multipart/mixed; boundary=--boundary_text_string\\r\\n\";\r\n  emlContents += \"\\r\\n----boundary_text_string\\r\\nContent-Type: text/html; charset=ISO-8859-1\\r\\n\";\r\n  emlContents += \"Content-Transfer-Encoding: quoted-printable\\r\\n\\r\\n\";\r\n\r\n  emlContents += \"<html><head></head><body>\";\r\n\r\n  if (typeof item.body !== \"undefined\") {\r\n    emlContents += item.body;\r\n  }\r\n\r\n  emlContents += \"</body></html>\";\r\n\r\n  for (const attachment of item.attachments) {\r\n    emlContents += \"\\r\\n\\r\\n----boundary_text_string\\r\\n\";\r\n    emlContents += `Content-Type: ${attachment.contentType}; name=\"${attachment.name}\"\\r\\n`;\r\n    emlContents += `Content-Disposition: attachment; filename=\"${attachment.name}\"; size=${attachment.size.toString()}\\r\\n`;\r\n    emlContents += \"Content-Transfer-Encoding: base64\\r\\n\\r\\n\";\r\n    //emlContents += `${attachment.base64Content}`;\r\n    emlContents += `${splitLines(attachment.base64Content, 76)}`;\r\n  }\r\n\r\n  emlContents += \"\\r\\n\\r\\n----boundary_text_string--\";\r\n\r\n  console.log(emlContents);\r\n\r\n  return emlContents;\r\n};\r\n\r\n// const getBuildDateString2 = () => {\r\n//   const date = new Date(111111);\r\n\r\n//   const months = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\n\r\n//   return (\r\n//     months[date.getMonth()] +\r\n//     \" \" +\r\n//     date.getDate().toString() +\r\n//     \" \" +\r\n//     date.getFullYear().toString() +\r\n//     \" \" +\r\n//     (date.getHours() < 10 ? \"0\" : \"\") +\r\n//     date.getHours().toString() +\r\n//     \":\" +\r\n//     (date.getMinutes() < 10 ? \"0\" : \"\") +\r\n//     date.getMinutes().toString()\r\n//   );\r\n// };\r\n\r\nconst openFlexSite2 = (searchTerm) => {\r\n  window.open(\r\n    `https://pimagov.sharepoint.com/sites/realproperty/SitePages/CollabHome.aspx?sw=bypass&search=${searchTerm}`\r\n  );\r\n};\r\n\r\nconst updateComposeUI = (refreshPanel, recips, recipientOneEmail) => {\r\n  return new Promise((resolve) => {\r\n    const item = Office.context.mailbox.item;\r\n\r\n    const mainBody = document.querySelector(\"#cflex-app-body\");\r\n    const prompt = document.querySelector(\"#cflex-select-item-prompt\");\r\n    const wait = document.querySelector(\"#cflex-wait\");\r\n    const searchLinkToContainer = document.querySelector(\"#cflex-search-to-container\");\r\n    const searchLinkSenderName = document.querySelector(\"#cflex-search-link-sender-name\");\r\n    const searchLinkSenderAddress = document.querySelector(\"#cflex-search-link-sender-address\");\r\n\r\n    if (searchLinkToContainer && searchLinkSenderName && searchLinkSenderAddress && mainBody && prompt && wait) {\r\n      if (refreshPanel) {\r\n        mainBody.style.display = \"none\";\r\n        prompt.style.display = \"none\";\r\n        wait.style.display = \"flex\";\r\n        searchLinkToContainer.replaceChildren();\r\n        searchLinkSenderName.replaceChildren();\r\n        searchLinkSenderAddress.replaceChildren();\r\n      }\r\n    } else {\r\n      // can't find our container, we'll bail\r\n      resolve();\r\n    }\r\n\r\n    if (!item) {\r\n      wait.style.display = \"none\";\r\n      prompt.style.display = \"flex\";\r\n      resolve();\r\n    }\r\n\r\n    _theMailItem = {\r\n      to: \"\",\r\n      sender: \"\",\r\n      subject: \"\",\r\n      date: \"\",\r\n      cc: \"\",\r\n      body: \"\",\r\n      attachments: [],\r\n    };\r\n\r\n    _theMailItem.sender = `${Office.context.mailbox.userProfile.displayName} (${Office.context.mailbox.userProfile.emailAddress})`;\r\n\r\n    const toArray = [];\r\n\r\n    recips.forEach((to) => {\r\n      if (recipientOneEmail === \"\") {\r\n        recipientOneEmail = to.emailAddress;\r\n      }\r\n\r\n      if (_theMailItem.to.length > 0) {\r\n        _theMailItem.to += \"; \";\r\n      }\r\n\r\n      _theMailItem.to += getEmailString2(to);\r\n\r\n      //_theMailItem.to += (_theMailItem.to.length > 0 ? \"; \" : \"\") + getEmailString2(to);\r\n\r\n      toArray.push({\r\n        displayName: to.displayName,\r\n        emailAddress: to.emailAddress,\r\n      });\r\n    });\r\n\r\n    item.cc.getAsync((a) => {\r\n      a.value.forEach((cc) => {\r\n        if (_theMailItem.cc.length > 0) {\r\n          _theMailItem.cc += \"; \";\r\n        }\r\n\r\n        theMailItem.cc += getEmailString2(cc);\r\n      });\r\n      item.body.getAsync(Office.CoercionType.Html, null, (b) => {\r\n        _theMailItem.body = b.value;\r\n\r\n        item.subject.getAsync((a) => {\r\n          _theMailItem.subject = a.value;\r\n\r\n          const promises = [];\r\n\r\n          item.getAttachmentsAsync((atts) => {\r\n            /*\r\nconst promises = [];\r\n\r\n  list.forEach(x => {\r\n    promises.push(asyncFn(x));\r\n  });\r\n\r\n  return Promise.all(promises);\r\n\r\n            */\r\n\r\n            for (const attachment of atts.value) {\r\n              promises.push(getAttachmentsContent2(item, attachment.id));\r\n            }\r\n\r\n            Promise.all(promises).then(() => {\r\n              const dragElement = document.querySelector(\"#cflex-drag-envelope\");\r\n              if (dragElement) {\r\n                dragElement.addEventListener(\"dragstart\", composeDragger);\r\n              }\r\n\r\n              // sender\r\n              const senderNameLink = document.createElement(\"a\");\r\n              senderNameLink.href = \"javascript:void(0)\";\r\n              senderNameLink.innerText = Office.context.mailbox.userProfile.displayName;\r\n              senderNameLink.style.paddingRight = \"20px\";\r\n              senderNameLink.addEventListener(\"click\", () =>\r\n                openFlexSite2(`${Office.context.mailbox.userProfile.displayName}`)\r\n              );\r\n\r\n              searchLinkSenderName.replaceChildren();\r\n              searchLinkSenderName.append(senderNameLink);\r\n\r\n              const senderNameAddress = document.createElement(\"a\");\r\n              senderNameAddress.href = \"javascript:void(0)\";\r\n              senderNameAddress.innerText = Office.context.mailbox.userProfile.emailAddress;\r\n              senderNameAddress.addEventListener(\"click\", () =>\r\n                openFlexSite2(`${Office.context.mailbox.userProfile.emailAddress}`)\r\n              );\r\n\r\n              searchLinkSenderAddress.replaceChildren();\r\n              searchLinkSenderAddress.append(senderNameAddress);\r\n\r\n              //flex-search-to-container\r\n\r\n              const searchLinkToContainer = document.querySelector(\"#cflex-search-to-container\");\r\n              if (searchLinkToContainer) {\r\n                searchLinkToContainer.replaceChildren();\r\n                toArray.forEach((to) => {\r\n                  if (to.emailAddress !== Office.context.mailbox.emailAddress) {\r\n                    const div = document.createElement(\"div\");\r\n\r\n                    const linkName = document.createElement(\"a\");\r\n                    linkName.href = \"javascript:void(0)\";\r\n                    linkName.innerHTML = `${to.displayName}`;\r\n                    linkName.addEventListener(\"click\", () => openFlexSite2(`${linkName.innerHTML}`));\r\n\r\n                    div.appendChild(linkName);\r\n                    if (searchLinkToContainer.children.length > 0) {\r\n                      div.style.paddingTop = \"10px\";\r\n                    }\r\n\r\n                    searchLinkToContainer.appendChild(div);\r\n\r\n                    if (to.displayName !== to.emailAddress) {\r\n                      const div2 = document.createElement(\"div\");\r\n                      const linkAddress = document.createElement(\"a\");\r\n                      linkAddress.href = \"javascript:void(0)\";\r\n                      linkAddress.innerHTML = `${to.emailAddress}`;\r\n\r\n                      linkAddress.addEventListener(\"click\", () => openFlexSite2(`${linkAddress.innerHTML}`));\r\n\r\n                      div2.appendChild(linkAddress);\r\n                      searchLinkToContainer.appendChild(div2);\r\n                    }\r\n                  }\r\n                });\r\n              }\r\n            });\r\n\r\n            wait.style.display = \"none\";\r\n            prompt.style.display = \"none\";\r\n            mainBody.style.visibility = \"hidden\";\r\n            mainBody.style.display = \"flex\";\r\n\r\n            // set height\r\n            const divElement = searchLinkToContainer;\r\n            divElement.style.resize = \"\";\r\n            divElement.style.overflow = \"\";\r\n            divElement.style.height = \"auto\";\r\n\r\n            if (divElement.getBoundingClientRect().height > 120) {\r\n              divElement.style.resize = \"vertical\";\r\n              divElement.style.overflow = \"auto\";\r\n              divElement.style.height = \"120px\";\r\n            }\r\n\r\n            mainBody.style.visibility = \"\";\r\n          });\r\n        });\r\n      });\r\n    });\r\n  });\r\n};\r\n\r\nconst getAttachmentsContent2 = (item, attId) => {\r\n  return new Promise((resolve) => {\r\n    item.getAttachmentContentAsync(attId, (c) => {\r\n      _theMailItem.attachments.push({\r\n        id: attId,\r\n        name: c.value.name,\r\n        contentType: c.value.contentType,\r\n        size: c.valuet.size,\r\n        base64Content: c.value.content,\r\n      });\r\n      resolve();\r\n    });\r\n  });\r\n};\r\n\r\nconst composeDragger = (e) => {\r\n  console.log(\r\n    JSON.stringify({\r\n      to: _theMailItem.to,\r\n      sender: _theMailItem.sender,\r\n      subject: _theMailItem.subject,\r\n      date: new Date().toUTCString(),\r\n      cc: _theMailItem.cc,\r\n      body: _theMailItem.body,\r\n      numAttachments: _theMailItem.attachments.length.toString(),\r\n      filename: `${_theMailItem.subject.replace(/[^a-z0-9+]+/gi, \"_\")}_${new Date().getMilliseconds().toString()}${Math.floor(Math.random() * 1000)}.eml`,\r\n      eml: getEMLFile2(_theMailItem),\r\n    })\r\n  );\r\n  e.dataTransfer.setData(\r\n    \"text\",\r\n    JSON.stringify({\r\n      to: _theMailItem.to,\r\n      sender: _theMailItem.sender,\r\n      subject: _theMailItem.subject,\r\n      date: new Date().toUTCString(),\r\n      cc: _theMailItem.cc,\r\n      body: _theMailItem.body,\r\n      numAttachments: _theMailItem.attachments.length.toString(),\r\n      filename: `${_theMailItem.subject.replace(/[^a-z0-9+]+/gi, \"_\")}_${new Date().getMilliseconds().toString()}${Math.floor(Math.random() * 1000)}.eml`,\r\n      eml: getEMLFile2(_theMailItem),\r\n    })\r\n  );\r\n};\r\n\r\nfunction onMessageComposeHandler(event) {\r\n  console.log(\"onMessageComposeHandler(): entered!\");\r\n\r\n  var options = { asyncContext: { callingEvent: event } };\r\n  Office.context.mailbox.item.notificationMessages.addAsync(\r\n    \"showInfoBarForSampleInstructions\",\r\n    {\r\n      type: Office.MailboxEnums.ItemNotificationMessageType.InsightMessage,\r\n      message: \"Open the Task Pane to save to Flex\",\r\n      icon: \"Icon.16x16\",\r\n      actions: [\r\n        {\r\n          actionText: \"Show Flex365x Task Pane\",\r\n          actionType: Office.MailboxEnums.ActionType.ShowTaskPane,\r\n          commandId: \"msgComposeOpenPaneButton\",\r\n          contextData: \"{''}\",\r\n        },\r\n      ],\r\n    },\r\n    options,\r\n    function (result) {\r\n      console.log(\"onMessageComposeHandler(): Notification message added\");\r\n      result.asyncContext.callingEvent.completed();\r\n    }\r\n  );\r\n}\r\n\r\nOffice.actions.associate(\"onMessageComposeHandler\", onMessageComposeHandler);\r\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane_msg_compose.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!doctype html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Flex365x Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\" style=\\\"background-color:#fff\\\"> <header class=\\\"ms-welcome__header\\\" style=\\\"padding:10px 20px 10px 20px;flex-direction:row;justify-content:center;background-color:#eee\\\"> <div style=\\\"background-color:#fff;padding:10px;border-radius:50%;margin-right:5px\\\"> <img width=\\\"50\\\" height=\\\"50\\\" src=\\\"https://i.ibb.co/HYRQ7Sb/flex365x-icon.png\\\" alt=\\\"Flex365x\\\" title=\\\"Flex365x\\\"/> </div> <div class=\\\"ms-font-su\\\" style=\\\"font-size:32px;margin-left:5px;font-weight:500;color:#666\\\">Welcome</div> </header> <div id=\\\"cflex-wait\\\" style=\\\"padding:50px 20px;font-size:16px;display:none;justify-content:center;width:100%;box-sizing:border-box\\\"> <span>Waiting for item...</span> </div> <div id=\\\"cflex-select-item-prompt\\\" style=\\\"padding:50px 20px;font-size:16px;display:none;justify-content:center;width:100%;box-sizing:border-box\\\"> <span> Select an item first for options to save to Flex365x </span> </div> <main id=\\\"cflex-app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div style=\\\"width:100%;text-align:center;padding:15px 0 0 0\\\"> <div style=\\\"color:#0178d4;cursor:grab;display:inline-block\\\" draggable=\\\"true\\\" title=\\\"Drag me!\\\" id=\\\"cflex-drag-envelope\\\"> <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"48\\\" height=\\\"48\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-envelope-fill\\\" viewBox=\\\"0 0 16 16\\\"> <path d=\\\"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z\\\"/> </svg> </div> </div> <div style=\\\"padding-top:15px;font-size:16px;font-weight:400\\\">Search for:</div> <div style=\\\"margin:10px 0 15px 0;font-size:16px;font-weight:400;width:280px\\\"> <div>Sender:</div> <span id=\\\"cflex-search-link-sender-name\\\"> </span> <span id=\\\"cflex-search-link-sender-address\\\"> </span> </div> <div style=\\\"width:280px;font-size:16px;font-weight:400\\\">Recipient(s):</div> <div id=\\\"cflex-search-to-container\\\" style=\\\"padding:0 0 15px 0;font-size:16px;font-weight:400;width:280px\\\"></div> <div style=\\\"padding-top:5px;font-size:16px;font-weight:400\\\">or</div> <div style=\\\"padding:5px 25px 25px 25px;font-size:16px;font-weight:400\\\"> <div style=\\\"padding-bottom:15px\\\">Drag the above envelope to a:</div> <div style=\\\"text-align:left;padding-bottom:15px;padding-left:30px\\\"> <ul> <li>Display form</li> <li>List Processor</li> <li>Super Search result</li> </ul> </div> <div>in a Flex365x site to upload this message to that item</div> <div style=\\\"padding:20px 0 0 0\\\">You can also drag the envelope to a Leads list to create a Lead!!</div> <div style=\\\"padding:20px 0 0 0;font-weight:700\\\"> Remember to come back to Outlook and click 'Send' after! </div> <div style=\\\"font-size:12px;padding:25px\\\">Code update 9/15/24 1705</div> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","o","obj","prop","Object","prototype","hasOwnProperty","call","p","b","document","baseURI","self","location","href","_theMailItem","to","sender","subject","date","cc","body","attachments","recipString","recipientOneEmail","toArray","Office","onReady","info","host","HostType","Outlook","console","log","querySelector","style","display","interval","setInterval","checkVisibility","item","context","mailbox","tempRecipString","getAsync","a","i","value","length","emailAddress","push","displayName","updateComposeUI","clearInterval","getEmailString2","details","retVal","indexOf","getEMLFile2","emlContents","splitLines","theString","partSize","res","idx","part","substr","join","Date","toUTCString","attachment","contentType","name","size","toString","base64Content","openFlexSite2","searchTerm","window","open","refreshPanel","recips","Promise","resolve","mainBody","prompt","wait","searchLinkToContainer","searchLinkSenderName","searchLinkSenderAddress","replaceChildren","userProfile","forEach","theMailItem","CoercionType","Html","promises","getAttachmentsAsync","atts","getAttachmentsContent2","id","all","then","dragElement","addEventListener","composeDragger","senderNameLink","createElement","innerText","paddingRight","append","senderNameAddress","div","linkName","innerHTML","appendChild","children","paddingTop","div2","linkAddress","visibility","divElement","resize","overflow","height","getBoundingClientRect","attId","getAttachmentContentAsync","c","valuet","content","e","JSON","stringify","numAttachments","filename","replace","getMilliseconds","Math","floor","random","eml","dataTransfer","setData","actions","associate","event","options","asyncContext","callingEvent","notificationMessages","addAsync","type","MailboxEnums","ItemNotificationMessageType","InsightMessage","message","icon","actionText","actionType","ActionType","ShowTaskPane","commandId","contextData","result","completed","URL"],"sourceRoot":""}